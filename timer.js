function getTimezone(){var e=(new Date).getTimezoneOffset();return-1*e/60}function getTimezoneOffsetStr(){var e=getTimezone(),t=parseInt(e),n=60*(e-Math.floor(e)),o="UTC";return o+=(e>=0?"+":"")+t,o+=0==n?"":":"+n}function str2sec(e){var t=e.split(":");return 60*+t[0]*60+60*+t[1]}function sec2str(e){var t=parseInt(e/3600)%24,n=parseInt(e/60)%60;return(10>t?"0"+t:t)+":"+(10>n?"0"+n:n)}function sortByTime(e,t){var n=new Date,o=str2sec(n.getHours()+":"+n.getMinutes()),s=e.lcsec-o+1800,a=t.lcsec-o+1800;return 0>s&&(s+=86400),0>a&&(a+=86400),a>s?-1:s>a?1:0}function getnowtime(){var e=new Date,t=e.getHours(),n=e.getMinutes(),o=e.getSeconds();return(10>t?"0"+t:t)+":"+(10>n?"0"+n:n)+":"+(10>o?"0"+o:o)}function refreshall(){var e=getCookie("lang")?getCookie("lang"):"en";$(".table-content").remove(),$.getJSON("./wbtime.json",function(t){for(var n=0,o=0,s=7,a=new Array;t.worldboss[n];){for(var r=0;t.worldboss[n].uptime[r];){sec=str2sec(t.worldboss[n].uptime[r]),lsec=sec+3600*getTimezone(),lsec>=86400&&(lsec-=86400),lsec<0&&(lsec+=86400);var i=t.worldboss[n].name[e]?t.worldboss[n].name[e]:t.worldboss[n].name.en,l=t.worldboss[n].map[e]?t.worldboss[n].map[e]:t.worldboss[n].map.en;a[o++]={id:t.worldboss[n].id,name:i,map:l,uptime:t.worldboss[n].uptime[r],upsec:sec,lctime:sec2str(lsec),lcsec:lsec,scale:t.worldboss[n].scale,waypoint:t.worldboss[n].waypoint},r++}n++}for(a.sort(sortByTime),n=0;o>n&&s>n;n++){var c=wbdonecheck(a[n].id)?" done":"",u='<div class="row table-content scale-'+a[n].scale+" "+a[n].id+'"><div class="col-1 wbframe'+c+'"><span class="wbid" hidden>'+a[n].id+"</span>"+a[n].name+'</div><div class="col-2 wbmap">'+a[n].map+'</div><div class="col-3 localtime">'+a[n].lctime+'<span class="utctime">'+a[n].uptime+'</span></div><div class="col-4 waypoint">'+a[n].waypoint+"</div></div>";$("#table-worldboss").append(u)}})}function getCookie(e){for(var t=e+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){var s=n[o].trim();if(0==s.indexOf(t))return s.substring(t.length,s.length)}return""}function setCookie(e,t,n){document.cookie=e+"="+t+"; expires="+n+";"}function wbdone(e){var t=getCookie("wbdone").split("/"),n=$.inArray(e,t);n>-1?t.splice(n,1):t.push(e),t.clean(""),e=t.join("/");var o=new Date,s=new Date;s.setUTCFullYear(o.getUTCFullYear()),s.setUTCMonth(o.getUTCMonth()),s.setUTCDate(o.getUTCDate()+1),s.setUTCHours(0),s.setUTCMinutes(0),s.setUTCSeconds(0),setCookie("wbdone",e,s.toUTCString())}function wbdonecheck(e){var t=getCookie("wbdone").split("/"),n=$.inArray(e,t);return n>-1?!0:!1}function TTSi(e){var t,n;t=document.getElementsByTagName("head")[0],n=document.createElement("iframe"),n.src="http://translate.google.com/translate_tts?ie=utf-8&tl=en&q="+escape(e),t.appendChild(n)}function TTS5(e){var t=new Audio;t.src="http://translate.google.com/translate_tts?ie=utf-8&tl=en&q="+escape(e),t.autoplay=!0,console.log(t)}function TTS(e){var t=new SpeechSynthesisUtterance(e);window.speechSynthesis.speak(t)}function getLang(e){$.getJSON("./lang.json",function(t){for(var n in t[e])if("lang-name"!=n){var o=t[e][n];"object"==typeof t[e][n]&&(o=t[e][n].join("")),$("#"+n).html(o)}})}function refreshlang(){var e=getCookie("lang");$.getJSON("./lang.json",function(t){for(var n in t)$("#lang-select").append(n==e?$("<option>").text(t[n]["lang-name"]).attr("value",n).attr("selected",!0):$("<option>").text(t[n]["lang-name"]).attr("value",n))}),getLang(e?e:"en")}Array.prototype.clean=function(e){for(var t=0;t<this.length;t++)this[t]==e&&(this.splice(t,1),t--);return this},$(document).ready(function(){$("#nowtimezone").append(" ("+getTimezoneOffsetStr()+")"),refreshlang(),refreshall(),setInterval(function(){$("#nowtime").html(getnowtime());var e=new Date,t=e.getSeconds();0==t&&refreshall()},1e3),$("#lang-select").change(function(){getLang($("#lang-select option:selected").val());var e=new Date,t=new Date;t.setFullYear(e.getFullYear()+10),setCookie("lang",$("#lang-select option:selected").val(),t),refreshall()}),$(document).on("click",".waypoint:not(:has(input))",function(){var e=this,t=$("<input class='chatlink' type='text' value='"+$(e).text()+"' />");$(e).html(t),t.one("focusout",function(){$(e).html($(this).val())}).focus().select()}),$(document).on("click",".wbframe",function(){var e=$(this).children("span.wbid").html();wbdone(e),$("."+e+">.wbframe").toggleClass("done")}),$(document).on("mouseenter",".table-content",function(){$("."+$(this).children(".wbframe").children(".wbid").html()).addClass("row-highlight")}),$(document).on("mouseleave",".table-content",function(){$("."+$(this).children(".wbframe").children(".wbid").html()).removeClass("row-highlight")})});